@model BirthdaySite.ViewModels.Forum.GroupViewModel

<div class="hidden-elements">
    <div id="hidden-group">
        @Model.Name
    </div>

    <div id="hidden-author">
        @User.Identity.Name
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="panel panel-default">
            <div class="panel-heading">@Model.Name`s group</div>
            <div class="panel-body">
                <div class="container">
                    @foreach (var message in Model.Messages)
                    {
                        <div class="row message-bubble">
                            <p class="text-muted">@message.Author</p>
                            <span>@message.Content</span>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<footer>

    <input id="input-message-content" type="text" name="message" />
    <button id="input-submit-button">Send</button>

    @Html.ActionLink("Back", "Index");
</footer>

<script>
    var rooms = "";

    $(document).ready(function () {

        $.connection.hub.start();

        var chat = $.connection.chat;

        $('#input-submit-button').click(function () {

            var msg = $('#input-message-content').val();

            var room = $('#hidden-group').text().trim();

            chat.server.joinRoom(room)

            chat.server.sendMessageToRoom(msg, room);
        });

        chat.client.addMessage = addMessage;
    });

    function addMessage(message, user) {
        $('.panel-body').children('.container').append('<div class="row message-bubble">' +
            '<p class="text-muted">' + user + '</p>' +
            '<span>' + message + '</span>' +
            '</div>');

        $('#input-message-content').val('');
    }
</script>